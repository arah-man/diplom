{% extends 'base.html' %}
{% load static %}

{% block title %}Корзина{% endblock %}

{% block content %}
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
    }
    

  <div class="header">
    <h1>Админ-панель</h1>
    <a href="{% url 'edit_product' %}">Добавить товар</a>
  </div>

  <div class="card">
    <h2>Фильтр заказов</h2>
    <form method="get">
      <label for="status">Статус:</label>
      <select name="status" id="status">
        <option value="">Все</option>
        {% for code, label in orders.model.STATUS_CHOICES %}
          <option value="{{ code }}" {% if status_filter == code %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <button type="submit">Применить</button>
    </form>
  </div>

  <div class="card">
    <h2>Заказы</h2>
    <table>
      <tr>
        <th>ID</th>
        <th>Пользователь</th>
        <th>Статус</th>
        <th>Изменить</th>
      </tr>
      {% for order in orders %}
        <tr>
          <td>{{ order.id }}</td>
          <td>{{ order.user.username }}</td>
          <td class="status">{{ order.get_status_display }}</td>
          <td>
            <form method="post" action="{% url 'update_order_status' order.id %}">
              {% csrf_token %}
              <select name="status">
                {% for code, label in orders.model.STATUS_CHOICES %}
                  <option value="{{ code }}" {% if order.status == code %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
              <button type="submit">Сохранить</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>
  </div>

  <div class="card">
    <h2>Товары</h2>
    <ul>
      {% for product in products %}
        <li>
          {{ product.name }} — {{ product.price }}₽
          [<a href="{% url 'edit_product' product.id %}">Редактировать</a>]
        </li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}