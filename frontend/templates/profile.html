{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="profile-container">
  <h1 class="profile-title">–í–ê–® –ü–†–û–§–ò–õ–¨</h1>

  <!-- –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
  <details class="user-info">
    <summary>üë§ –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</summary>
    <div class="user-info-content">
      <p><strong>–ò–º—è:</strong> {{ user.first_name }}</p>
      <p><strong>–§–∞–º–∏–ª–∏—è:</strong> {{ user.last_name }}</p>
      <p><strong>–û—Ç—á–µ—Å—Ç–≤–æ:</strong> {{ user.middle_name|default:"‚Äî" }}</p>
      <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ user.phone|default:"‚Äî" }}</p>
      <p><strong>–ü–æ—á—Ç–∞:</strong> {{ user.email }}</p>
      <p><strong>–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ user.birth_date|date:"d.m.Y" }}</p>
    </div>
  </details>

  <!-- –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ -->
  <h2 class="order-history-title">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
  {% for order in orders %}
    <div class="order-block">
      <p><strong>–ó–∞–∫–∞–∑ ‚Ññ{{ order.id }}</strong> –æ—Ç {{ order.date_at|date:"d.m.Y" }}</p>
      <p><strong>–°—Ç–∞—Ç—É—Å:</strong> {{ order.get_status_display }}</p>
      <p><strong>–û–ø–ª–∞—Ç–∞:</strong> {{ order.get_type_payment_display }}</p>
      <p><strong>–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏:</strong> {{ order.address|default:"‚Äî" }}</p>

      <table class="order-table">
        <thead>
          <tr>
            <th>–¢–æ–≤–∞—Ä</th>
            <th>–¶–≤–µ—Ç</th>
            <th>–†–∞–∑–º–µ—Ä</th>
            <th>–ö–æ–ª-–≤–æ</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–ò—Ç–æ–≥–æ</th>
          </tr>
        </thead>
        <tbody>
          {% for item in order.items.all %}
            <tr>
              <td>{{ item.product.name }}</td>
              <td>
                {% if item.color %}
                  <span class="color-circle" style="background-color: {{ item.color.hex_code }}"></span>
                  {{ item.color.name }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>
                {% if item.size %}
                  {{ item.size.name }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>{{ item.quantity }}</td>
              <td>{{ item.price }} ‚ÇΩ</td>
              <td>{{ item.total_price }} ‚ÇΩ</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <p class="order-total">–û–±—â–∞—è —Å—É–º–º–∞: <strong>{{ order.total_price }} ‚ÇΩ</strong></p>
    </div>
  {% empty %}
    <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.</p>
  {% endfor %}
</div>
{% endblock %}
